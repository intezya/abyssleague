version: "2"

run:
  timeout: 5m
  issues-exit-code: 1000
  tests: false
  modules-download-mode: readonly
  allow-parallel-runners: true

linters:
  default: all

  disable:
    - wrapcheck
    - ireturn # ???
    - nonamedreturns
    - gochecknoinits # not configurable (swaggo docs must be excluded)
    - gochecknoglobals # not configurable (swaggo docs, custom errors and validator must be excluded)
    - errname # not configurable (canonical custom http-like errors must be excluded)
    - testpackage
    - bodyclose
    - godox
    # Must be turned on after
    - revive
    - depguard

  settings:
    gomoddirectives:
      replace-local: true

    funlen:
      lines: 90

    cyclop:
      max-complexity: 15

    recvcheck:
      exclusions:
        - "*.Value"
        - "*.Scan"

    tagalign:
      sort: true

      order:
        - json
        - yaml
        - yml
        - toml
        - mapstructure
        - binding
        - validate
        # Tag for swaggo (ordered after json and validate, because if an example exists,
        # json and validate also exist (if validations exist in principle))
        - example

    tagliatelle:
      case:
        rules:
          json: snake

    varnamelen:
      ignore-decls:
        - c *fiber.Ctx
        - T any
        - w http.ResponseWriter
        - w io.WriteCloser
        - r *http.Request
        - t testing.T
        - wg sync.WaitGroup

      ignore-names:
        - id  # Canonical naming (any identification)
        - ok # Canonical naming (boolean value)
        - ch # Canonical naming (chan)
        - tt # Canonical naming (test)
        - tc # Canonical naming (test case)

      ignore-type-assert-ok: true
      ignore-map-index-ok: true


  exclusions:
    rules:
      - path: docs/docs.go # autogenerated by swaggo/swag
        linters:
          - lll
      - path: internal/common/errors # custom application errors
        linters:
          - err113
      - path: .*_test\.go$
        linters:
          - exhaustruct
formatters:
  enable:
    - gci
    - gofmt
    - gofumpt
    - golines

issues:
  fix: true
